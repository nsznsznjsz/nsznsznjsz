const path = require("path")
const spawn = require("cross-spawn")

module.exports = {
  getGitCreatedTimeStamp,
  getGitLastUpdatedTimeStamp,
}

function getGitLastUpdatedTimeStamp(filePath) {
  let lastUpdated
  try {
    lastUpdated =
      parseInt(
        spawn
          .sync("git", ["log", "-1", "--format=%at", path.basename(filePath)], {
            cwd: path.dirname(filePath),
          })
          .stdout.toString("utf-8")
      ) * 1000
  } catch (e) {
    /* do not handle for now */
  }
  return lastUpdated
}

function getGitCreatedTimeStamp(filePath) {
  let created
  try {
    created =
      parseInt(
        spawn
          .sync(
            "git",
            ["log", "-1", "--format=%at", "--reverse", path.basename(filePath)],
            { cwd: path.dirname(filePath) }
          )
          .stdout.toString("utf-8")
      ) * 1000
  } catch (e) {
    /* do not handle for now */
  }
  return created
}
